<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>상품 상세 - 동네마켓</title>
    <link rel="stylesheet" th:href="@{/css/board_detail_market.css}">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script th:src="@{/js/reservation_vote.js}"></script>
</head>
<body>

<!-- Header -->
<div th:replace="/header :: header"></div>

<section class="board-detail-section">
    <div class="board-detail-container">
        
        <!-- 글 정보 -->
        <div class="board-header">
            <h2 th:text="${reservation.subject}">상품 제목</h2>
            <div class="board-meta">
                <span>작성자: <b th:text="${reservation.author.username}">작성자</b></span>
                <span>등록일: <span th:text="${#temporals.format(reservation.createdate,'yyyy-MM-dd HH:mm')}"></span></span>
                <span th:if="${reservation.modifydate != null}">수정일: <span th:text="${#temporals.format(reservation.modifydate,'yyyy-MM-dd HH:mm')}"></span></span>
            </div>
        </div>

      
        <div class="board-content">
    <p th:text="${reservation.content}">상품 설명</p>
    <p>가격: <span th:text="${reservation.price}+'원'">0원</span></p>
    <p>거래 위치: <span th:text="${reservation.location}">서울</span></p>
    <p>예약 일자: <span th:text="${reservation.reserveDate}+'-'+${reservation.reserveTime}">날짜</span></p>
	</div>

      <!-- 찜하기 / 예약 관련 버튼 -->
<div class="board-actions">

    <!-- 로그인한 사용자일 때 -->
    <th:block th:if="${#authorization.expression('isAuthenticated()')}">

        <!-- 찜하기 버튼: 로그인한 누구에게나 표시 -->
        <button class="vote-btn"
                th:onclick="'location.href=\'/reservation/vote/'+${reservation.id}+'\''">
            👍 찜하기 (<span th:text="${#lists.size(reservation.voter)}">0</span>)
        </button>

        <!-- 글 작성자 본인일 때만 표시 -->
        <th:block th:if="${#authentication.principal != null and reservation.author.username == #authentication.principal.username}">
            <button class="complete-btn"
                    th:onclick="'location.href=\'/reservation/complete/'+${reservation.id}+'\''">
                ✅ 거래 완료
            </button>

            <button class="edit-btn"
                    th:onclick="'location.href=\'/reservation/modify/'+${reservation.id}+'\''">
                ✏️ 수정하기
            </button>

            <button class="delete-btn"
                    th:onclick="'if(confirm(\'정말 삭제하시겠습니까?\')) location.href=\'/reservation/delete/'+${reservation.id}+'\''">
                🗑️ 삭제
            </button>
        </th:block>

    </th:block>

    <!-- 글 목록 버튼 (모든 사용자 가능) -->
    <a th:href="@{/reservation/list}" class="list-btn">글 목록</a>
</div>



        

    </div>
</section>

<!-- Footer -->
<div th:replace="/footer :: footer"></div>

</body>
</html>
